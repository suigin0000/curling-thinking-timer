<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>カウントダウンタイマー</title>
    <script>
//001----------javascriptの開始--------------------------------------------------
// ページが読み込まれたときに
    window.onload = function(){
//002----------スタートボタンをクリックして発火 0から1--------------------------------------
// スタートボタンを設定、eventlistnerはイベントが起こったら関数を呼び出してそっちを優先的に処理する
            var start = document.getElementById('start');
            start.addEventListener('click',count_start, false);
            // var start = document.getElementById('start');
            // start.addEventListener('keydown', (e) => {
            //     const key = e.keyCode;
            //     if(key === 39){
            //         // count_start
            //         console.log('押せました')
            //     }
            // });
//003----------ストップボタンをクリックして発火 0から1--------------------------------------
            var stop = document.getElementById("stop");
            stop.addEventListener("click",count_stop, false);
//004----------リセットボタンをクリックして発火 0から1--------------------------------------
            var reset = document.getElementById("reset");
            reset.addEventListener("click",count_reset,false);
        }     
//-----------------------------------------------------------------------------
//変数の定義---------------------------------------------------------------------
    var count   = 2280;     //カウントダウンの数字を格納する変数
    var min     = 0;       //残り時間「分」を格納する変数
    var sec     = 0;       //残り時間「秒」を格納する変数
    var start_f = false;
    var interval;
//-----------------------------------------------------------------------------

//004----------スタート開始------------------------------------------------------
function count_start(){
//0041------------二度押しを防止する
        if (start_f === false) {
//0042------------1秒毎にcont_down関数を呼び出す
// setInterval(呼び出す関数,呼び出す間隔(ms))
          interval = setInterval(count_down,1000);
        // start_f　最初falseにして処理した後にtrueにすると一度だけ処理することができる
        // start　flag　できる、できない　is有効な時にtrue
          start_f = true;
        }
    }
//-----------------------------------------------------------------------------

//005------------カウントダウンの開始---------------------------------------------
    function count_down(){
//006--------------------------------------------------------------------------
        if(count === 1){
            var display = document.getElementById("default");
            display.style.color = 'red';
            display.innerHTML = "TIME UP!";
            clearInterval(interval);
//007-------------------------------------------------------------------------
        } else {
//008-------------------------------------------------------------------------
            count--;
//009----------Math.floor関数を使って小数点になった分を整数に変換する。---------------
// ceil　天井関数　切り上げ
// floor　床関数　切り捨て
// int型で計算できるならそうしたい
// 秒を出してから分を出したほうがいい
            // min = Math.floor(count / 60);
//010------------60秒で割ったあまりが秒となる-------------------------------------
            sec = count % 60;
            // あまりが引かれているので割り切れる、時間処理でよく使われる
            min = (count - sec)/60;
            var count_down = document.getElementById("default");
            count_down.innerHTML = String(min).padStart(2, "0")+':'+ String(sec).padStart(2,"0");
            // ↑数値を文字列に変換すると表示できるようになる
            // count_down.innerHTML = ("0"+min).slice(-2) +"：" + ("0"+sec).slice(-2);
        }
    }
    
//006-----------ストップボタンの押下---------------------------------------
// 変数intervalをクリアして処理をやめる
    function count_stop(){
        clearInterval(interval);
        // startボタンを再び押せるようにしている
        start_f = false;
    }

//007-----------リセットボタンの押下---------------------------------------
    function count_reset(){
       clearInterval(interval);
        count = 2280;
        start_f = false;
        var count_down = document.getElementById("default");
        count_down.style.color = 'black';
        count_down.innerHTML = "38：00";
    }    
    </script>

</head>
<body>
<!-----タイマーの3分を表示------------------------------------------>
            <p id="default">38：00</p>
<!-----スタートボタンを表示----------------------------------------->
            <button id="start">スタート</button>
<!-----ストップボタンを表示----------------------------------------->
            <button id="stop">ストップ</button>
<!-----リセットボタンを表示----------------------------------------->
            <button id="reset">リセット</button>
</body>
</html>
